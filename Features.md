### 1. Multi-Modal Knowledge Ingestion (The "Data" Layer)

* **AI Vision for Technical Diagrams:**
* *Feature:* It goes beyond text. The system extracts images from PDFs, intelligently filters out noise (like small icons), and uses **GPT-4o** to generate detailed textual descriptions of technical diagrams and machine parts.
* *Code Reference:* `analyze_image_with_gpt4o`, `safe_analyze_image`.


* **Automated Knowledge Graph Construction:**
* *Feature:* Converts unstructured text and image descriptions into a structured Knowledge Graph (Nodes & Relationships) using an LLM to map entities like "Machine" to "Part".
* *Code Reference:* `LLMGraphTransformer`, `ingest_node`.


* **Semantic Chunking & Linking:**
* *Feature:* Intelligently splits documents based on meaning (Semantic Chunker) rather than just character count, linking specific document sections directly to Machinery nodes in the graph.



### 2. Hybrid RAG Chat Agent (The "Brain")

* **Hybrid Retrieval (Graph + Vector):**
* *Feature:* The chatbot combines **Vector Search** (ChromaDB) for finding similar unstructured text with **Graph Search** (Neo4j) for finding deep, structured relationships.
* *Code Reference:* `process_chat_query`.


* **Dynamic Cypher Generation:**
* *Feature:* The AI writes its own database queries (Cypher) on the fly based on the user's natural language question to query the graph directly.
* *Code Reference:* `GraphCypherQAChain`.


* **Context-Aware Filtering:**
* *Feature:* Users can scope the AI's "memory" by filtering for specific "Machinery" or "Data Source" (e.g., "Only answer based on the ZX-500 Manual").
* *Code Reference:* `get_knowledge_graph_filters`, `get_dynamic_schema_context`.


* **Explainable AI (Traceability):**
* *Feature:* Every response includes a "Trace Graph" and "Citations," showing exactly which nodes and document chunks were used to generate the answer.



### 3. Agentic Automation & Simulation (The "Action" Layer)

* **IoT Failure Simulation:**
* *Feature:* A "Simulate Log" button triggers a realistic machine failure scenario (e.g., "Critical Overheat on Sensor Array B") to test the system's reaction.
* *Code Reference:* `/api/simulation/log`.


* **Autonomous Work Order Management:**
* *Feature:* Upon detecting a failure, the system automatically creates a Work Order with calculated priority, deadline, and required skills.


* **Intelligent Dispatch Agent:**
* *Feature:* An AI agent analyzes the problem and makes a decision:
* **Assign Technician:** Finds the best available technician with the right skills (e.g., L3 Robotics).
* **Supply Chain Trigger:** If the required part is missing, it automatically places a "Purchase Order" instead of assigning a human.


* *Code Reference:* `WorkOrderAssignmentAgent` (in `main.py`).



### 4. Interactive Visualization & Dashboard

* **Live Graph Visualization:**
* *Feature:* A real-time visual representation of the Knowledge Graph, color-coded by type (Cyan for Machines, Purple for Techs, Yellow for Tasks).
* *Code Reference:* `/api/graph/visualize`.


* **Real-Time Dashboard Stats:**
* *Feature:* Displays live metrics like Active Nodes, Manuals Processed, and System Uptime directly from the Graph database.


* **Compliance Alert System:**
* *Feature:* A live feed of critical alerts generated by the AI agent that requires human resolution or approval.



### 5. Functional Capabilities (Business Value)

* **Inventory-Aware Work Order Management:**
* *Feature:* Before assigning a human, the agent checks the Knowledge Graph (simulated) to see if the required spare parts are in stock.
* *Demo Point:* Show the agent detecting "Sensor Array B" is missing and **refusing** to assign a technician until parts are available.
* *Code Reference:* `check_spare_parts_inventory`.


* **Automated Supply Chain Trigger (Auto-PO):**
* *Feature:* If a critical part is missing, the system autonomously generates a **Purchase Order (PO)** ID and puts the Work Order on "Supply Chain Hold."
* *Demo Point:* "Notice how the system didn't just fail; it proactively created PO-1234 to resolve the bottleneck."
* *Code Reference:* `generate_purchase_order`.


* **Risk & Compliance Analysis:**
* *Feature:* Every assignment runs through a compliance check (Are techs available?) and a risk analysis (Does the missing part extend downtime?).
* *Code Reference:* `validate_compliance`, `analyze_risk_factors`.



### 6. Advanced Engineering (Technical "Wow" Factor)

* **Dual-Store Architecture:**
* *Feature:* Synchronizes data between **Neo4j** (Graph) and **ChromaDB** (Vector) to leverage the strengths of both databases.


* **Parallel Processing:**
* *Feature:* Uses `asyncio` and `semaphores` to process multiple images concurrently during ingestion without hitting API rate limits.


* **Self-Correcting "Critique" Loop:**
* *Feature:* The agent utilizes a **Reflexion Pattern**. It generates a plan, and a separate "Reasoning Node" critiques it. If data is insufficient (e.g., no technicians found), it loops back to adjust its search parameters.
* *Code Reference:* `reasoning_critique_node`, `route_critique`.


* **Dual-LLM Cognitive Architecture:**
* *Feature:* Optimizes for cost and intelligence by using a Router:
* **Small Model (GPT-4o-mini):** For fast, simple tasks like query construction.
* **Reasoning Model (DeepSeek-R1):** For complex logic, critique, and validation.


* *Code Reference:* `get_llm`, `SMALL_LLM_MODEL`, `REASONING_LLM_MODEL`.


